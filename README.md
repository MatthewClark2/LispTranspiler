# lispc

lispc is a Rust crate aimed at generating C code from a roughly Scheme flavored LISP.

## Tests

The compilation modules all use Rust's default testing facilities. The C runtime uses the CuTest framework for unit
testing, the details of which are provided in the `cutest-1.5` directory.

## Building

The Rust portion of the project uses stable Cargo. The C portion is built with CMake. In order to compile an executable
from the output generated by `lispc`, use the `run_generated.sh` bash script. A similar Windows command line script will
probably be made in the future. For the sake of transparency, the script:

1. Calls the lispc program, and saves its output to a file called `out.c`.
2. Makes a new directory called `tmp/` in the current directory, and invokes CMake.
3. Invokes `make out`, which compiles an exectuble for the generated C code.
4. Executes the generated program.
l
5. Leaves the `tmp` directory.

If the script fails at any point, it leaves the `tmp/` directory.

## TODO(matthew-c21):

There is a bug that prevents redefinition of variables. Therefore, there needs to be a set of known user variables so that 
their values can be reused.

Finish implementing the conditional special form.

Add a symbol table to keep track of different symbols and their respective scopes so that unknown symbols can be caught
at transpile time rather than at compile time. Consider adding a special name mangling mode for library vs. executable
code. Only the definitions (vars, fns, macros) from a file should be inherited into a library file. This essentially
means that compiling a file in library mode discards all top-level expressions, while compiling a file as an executable
should 

Improve documentation for the format of symbols, numbers, keywords, and hashmap literals. Also add more documentation
for the behavior of standard library functions.

Add `do`, `loop`, `lambda`, special forms.

Modify the C runtime to use a reference counting garbage collection system. The garbage collector should probably be
passed between functions as a global-ish variable. This would make it easier to later change the codebase to accept a
general `LispState` type object.

Implement

